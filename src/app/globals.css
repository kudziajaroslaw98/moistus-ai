@import 'tailwindcss';
@plugin "@tailwindcss/typography";
@import '@xyflow/react/dist/base.css';
@import 'tw-animate-css';

@custom-variant dark (&:is(.dark *));

@utility touch-hitbox {
	position: relative;

	&::before {
		content: '';
		position: absolute;
		display: block;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 100%;
		height: 100%;
		min-height: 44px;
		min-width: 44px;
		z-index: 1000;
	}
}

@theme inline {
	/* ===========================
	   PRIMITIVE COLOR SCALES (OKLCH)
	   =========================== */

	/* Neutral Scale - Pure gray (0 chroma) for universal compatibility */
	--color-neutral-50: oklch(0.985 0 0);
	--color-neutral-100: oklch(0.965 0 0);
	--color-neutral-200: oklch(0.925 0 0);
	--color-neutral-300: oklch(0.865 0 0);
	--color-neutral-400: oklch(0.745 0 0);
	--color-neutral-500: oklch(0.595 0 0);
	--color-neutral-600: oklch(0.475 0 0);
	--color-neutral-700: oklch(0.375 0 0);
	--color-neutral-800: oklch(0.275 0 0);
	--color-neutral-900: oklch(0.195 0 0);
	--color-neutral-950: oklch(0.14 0 0);

	/* Primary Scale - Blue (hue 250°) */
	--color-primary-50: oklch(0.97 0.02 250);
	--color-primary-100: oklch(0.93 0.05 250);
	--color-primary-200: oklch(0.87 0.09 250);
	--color-primary-300: oklch(0.78 0.13 250);
	--color-primary-400: oklch(0.68 0.17 250);
	--color-primary-500: oklch(0.58 0.2 250);
	--color-primary-600: oklch(0.48 0.2 250);
	--color-primary-700: oklch(0.4 0.18 250);
	--color-primary-800: oklch(0.33 0.14 250);
	--color-primary-900: oklch(0.27 0.1 250);

	/* Success Scale - Green (hue 145°) */
	--color-success-50: oklch(0.97 0.03 145);
	--color-success-100: oklch(0.93 0.06 145);
	--color-success-200: oklch(0.87 0.1 145);
	--color-success-300: oklch(0.78 0.14 145);
	--color-success-400: oklch(0.68 0.17 145);
	--color-success-500: oklch(0.6 0.19 145);
	--color-success-600: oklch(0.5 0.18 145);
	--color-success-700: oklch(0.42 0.16 145);
	--color-success-800: oklch(0.35 0.13 145);
	--color-success-900: oklch(0.29 0.1 145);

	/* Warning Scale - Amber (hue 85°) */
	--color-warning-50: oklch(0.98 0.03 85);
	--color-warning-100: oklch(0.95 0.07 85);
	--color-warning-200: oklch(0.9 0.12 85);
	--color-warning-300: oklch(0.83 0.16 85);
	--color-warning-400: oklch(0.75 0.18 85);
	--color-warning-500: oklch(0.68 0.19 85);
	--color-warning-600: oklch(0.6 0.18 85);
	--color-warning-700: oklch(0.5 0.15 85);
	--color-warning-800: oklch(0.42 0.12 85);
	--color-warning-900: oklch(0.35 0.09 85);

	/* Error Scale - Red (hue 25°) */
	--color-error-50: oklch(0.97 0.02 25);
	--color-error-100: oklch(0.93 0.05 25);
	--color-error-200: oklch(0.87 0.1 25);
	--color-error-300: oklch(0.79 0.15 25);
	--color-error-400: oklch(0.69 0.19 25);
	--color-error-500: oklch(0.59 0.22 25);
	--color-error-600: oklch(0.49 0.21 25);
	--color-error-700: oklch(0.41 0.18 25);
	--color-error-800: oklch(0.34 0.14 25);
	--color-error-900: oklch(0.28 0.1 25);

	/* Brand Scale - Coral (hue 25°) for brand emphasis, not errors */
	--color-brand-coral: oklch(0.79 0.15 25);

	/* ===========================
	   SEMANTIC TOKENS (Dark Mode)
	   =========================== */

	/* Backgrounds - Elevation system (lighter = closer) */
	--color-base: oklch(0.11 0 0);
	--color-surface: oklch(0.14 0 0);
	--color-elevated: oklch(0.18 0 0);
	--color-overlay: oklch(0.25 0 0);

	/* Borders */
	--color-border-subtle: oklch(0.20 0 0);
	--color-border-default: oklch(0.28 0 0);
	--color-border-strong: oklch(0.38 0 0);

	/* Text Hierarchy */
	--color-text-primary: var(--color-neutral-50);
	--color-text-secondary: var(--color-neutral-400);
	--color-text-tertiary: var(--color-neutral-500);
	--color-text-disabled: oklch(0.40 0 0);

	/* Interactive States */
	--color-interactive-primary: var(--color-primary-500);
	--color-interactive-primary-hovered: var(--color-primary-400);
	--color-interactive-primary-pressed: var(--color-primary-600);

	--color-interactive-success: var(--color-success-500);
	--color-interactive-success-hovered: var(--color-success-400);
	--color-interactive-success-pressed: var(--color-success-600);

	--color-interactive-warning: var(--color-warning-500);
	--color-interactive-warning-hovered: var(--color-warning-400);
	--color-interactive-warning-pressed: var(--color-warning-600);

	--color-interactive-error: var(--color-error-500);
	--color-interactive-error-hovered: var(--color-error-400);
	--color-interactive-error-pressed: var(--color-error-600);

	/* ===========================
	   SHADCN/UI COMPATIBILITY TOKENS
	   =========================== */

	/* Map semantic tokens to shadcn naming convention */
	--color-background: var(--color-bg-base);
	--color-foreground: var(--color-text-primary);

	--color-card: var(--color-bg-surface);
	--color-card-foreground: var(--color-text-primary);

	--color-popover: var(--color-bg-elevated);
	--color-popover-foreground: var(--color-text-primary);

	--color-primary: var(--color-interactive-primary);
	--color-primary-foreground: oklch(0.14 0 0); /* Dark text on primary */

	--color-secondary: var(--color-neutral-700);
	--color-secondary-foreground: var(--color-text-primary);

	--color-muted: var(--color-neutral-800);
	--color-muted-foreground: var(--color-text-secondary);

	--color-accent: var(--color-neutral-700);
	--color-accent-foreground: var(--color-text-primary);

	--color-destructive: var(--color-interactive-error);
	--color-destructive-foreground: var(--color-text-primary);

	--color-border: var(--color-border-default);
	--color-input: var(--color-border-default);
	--color-ring: var(--color-interactive-primary);

	/* ===========================
	   BORDER RADIUS
	   =========================== */

	--radius-sm: calc(var(--radius) - 4px);
	--radius-md: calc(var(--radius) - 2px);
	--radius-lg: var(--radius);
	--radius-xl: calc(var(--radius) + 4px);

	/* Typography */
	--font-sans: var(--font-geist-sans);
	--font-mono: var(--font-geist-mono);
	--font-lora: var(--font-lora);
}

/* Base radius value */
:root {
	--radius: 0.625rem;
	--toast-offset-inline: 1rem;
	--mind-map-toolbar-clearance: 0px;
	--toast-offset-bottom: calc(
		env(safe-area-inset-bottom, 0px) + 1rem + var(--mind-map-toolbar-clearance)
	);
	--toast-offset-bottom-mobile: calc(
		env(safe-area-inset-bottom, 0px) + 1rem + var(--mind-map-toolbar-clearance)
	);
}

body[data-has-bottom-toolbar='true'] {
	--toast-offset-bottom: calc(
		env(safe-area-inset-bottom, 0px) + 1rem + var(--mind-map-toolbar-clearance)
	);
	--toast-offset-bottom-mobile: calc(
		env(safe-area-inset-bottom, 0px) + 1rem + var(--mind-map-toolbar-clearance)
	);
}

@media (max-width: 600px) {
	.app-toaster[data-sonner-toaster][data-x-position='right'] {
		left: auto !important;
		right: var(--mobile-offset-right) !important;
		width: min(
			18rem,
			calc(100vw - (2 * var(--toast-offset-inline)))
		) !important;
	}

	.app-toaster[data-sonner-toaster][data-x-position='right'] [data-sonner-toast] {
		left: auto !important;
		right: 0 !important;
		width: min(
			18rem,
			calc(100vw - (2 * var(--toast-offset-inline)))
		) !important;
	}
}

/* ===========================
   ANIMATIONS
   =========================== */

/* Connection line animation */
@keyframes dash-flow {
	to {
		stroke-dashoffset: -20;
	}
}

.animate-dash-flow {
	animation: dash-flow 2s linear infinite;
}

/* Hero shimmer text — animated gradient that feels alive */
@keyframes hero-shimmer-shift {
	0% { background-position: 0% 50%; }
	50% { background-position: 100% 50%; }
	100% { background-position: 0% 50%; }
}

.hero-shimmer {
	background: linear-gradient(
		90deg,
		#e0856a 0%,
		#f4a88a 25%,
		#ffffff 50%,
		#f4a88a 75%,
		#e0856a 100%
	);
	background-size: 200% 100%;
	-webkit-background-clip: text;
	background-clip: text;
	color: transparent;
	animation: hero-shimmer-shift 6s ease-in-out infinite;
}

.hero-shimmer-blue {
	background: linear-gradient(
		90deg,
		#5b80e8 0%,
		#8aadff 25%,
		#ffffff 50%,
		#8aadff 75%,
		#5b80e8 100%
	);
	background-size: 200% 100%;
	-webkit-background-clip: text;
	background-clip: text;
	color: transparent;
	animation: hero-shimmer-shift 6s ease-in-out infinite;
	animation-delay: -3s;
}

@media (prefers-reduced-motion: reduce) {
	.hero-shimmer,
	.hero-shimmer-blue {
		animation: none !important;
	}
}

/* Node network animations (hero background) */
@keyframes node-float {
	0%, 100% { transform: translateY(0); }
	50% { transform: translateY(-8px); }
}

@keyframes node-pulse {
	0%, 100% { opacity: 0.08; }
	50% { opacity: 0.15; }
}

@media (prefers-reduced-motion: reduce) {
	.animate-node-float,
	.animate-node-pulse {
		animation: none !important;
	}
}

/* Fade in animation */
@keyframes fade-in {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}

/* Fade in with upward motion */
@keyframes fade-in-up {
	0% {
		opacity: 0;
		transform: translateY(20px);
	}
	100% {
		opacity: 1;
		transform: translateY(0);
	}
}

/* Animation utilities - Fast (0.2s max per guidelines) */
.animate-fade-in {
	animation: fade-in 0.2s ease-out forwards;
}

.animate-fade-in-up {
	animation: fade-in-up 0.2s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
}

/* ===========================
   ACCESSIBILITY
   =========================== */

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
	.animate-fade-in-up {
		animation: fade-in 0.2s ease-out forwards;
	}

	/* Disable transform-based animations */
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}

	/* Allow opacity transitions */
	* {
		transition-property: opacity, color, background-color !important;
	}
}

/* ===========================
   SCROLLBAR STYLING
   =========================== */

* {
	/* Firefox */
	scrollbar-width: thin;
	scrollbar-color: rgba(255, 255, 255, 0.15) transparent;
}

/* Webkit browsers (Chrome, Safari, Edge) */
*::-webkit-scrollbar {
	width: 8px;
	height: 8px;
}

*::-webkit-scrollbar-track {
	background: transparent;
}

*::-webkit-scrollbar-thumb {
	background: rgba(255, 255, 255, 0.15);
	border-radius: 4px;
	transition: background 0.2s ease;
}

*::-webkit-scrollbar-thumb:hover {
	background: rgba(255, 255, 255, 0.25);
}

/* ===========================
   UTILITY CLASSES
   =========================== */

/* Radial gradient utility */
.bg-radial-gradient {
	background: radial-gradient(
		ellipse at center,
		var(--tw-gradient-from) 0%,
		var(--tw-gradient-via, var(--tw-gradient-from)) 50%,
		var(--tw-gradient-to) 100%
	);
}

/* ===========================
   TAILWIND BASE LAYER
   =========================== */

@layer base {
	* {
		@apply border-border outline-ring/50;
		-webkit-font-smoothing: subpixel-antialiased;
	}
	body {
		@apply bg-background text-foreground;
	}
}

/* ===========================
NODE EDITOR OVERRIDES
   =========================== */

.ͼ1.cm-focused {
	@apply rounded-[5px] outline outline-primary-500/50;
}
